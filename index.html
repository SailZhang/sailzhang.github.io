<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2" />






<meta property="og:type" content="website">
<meta property="og:title" content="AiTel">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="AiTel">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="AiTel">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>AiTel</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">AiTel</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Startseite
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archiv
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/05/perf/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Finn Cheong">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AiTel">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/05/perf/" itemprop="url">linux 性能调优</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-11-05T17:09:06+08:00">
                2018-11-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##使用perf</p>
<p>首先需要linux支持使用perf命令，可以以下命令进行安装</p>
<blockquote>
<p>sudo apt-get install linux-tools-common linux-tools-generic linux-tools-<code>uname -r</code></p>
</blockquote>
<p>在perf中可以用perf stat对某个进程进行分析</p>
<blockquote>
<p>perf list </p>
</blockquote>
<p>可以列出所有的事件采集点</p>
<p>##画火焰图</p>
<blockquote>
<p>perf record -a -p pid -g</p>
</blockquote>
<p>-g 记录堆栈，-p指定perf的进程id</p>
<blockquote>
<p>perf script &gt; out.perf</p>
</blockquote>
<p>将相关信息dump到out.perf, 然后</p>
<blockquote>
<p>git clone –depth 1 <a href="https://github.com/brendangregg/FlameGraph.git" target="_blank" rel="external">https://github.com/brendangregg/FlameGraph.git</a><br>stackcollapse-perf.pl out.perf &gt; out.folded<br>flamegraph.pl out.folded &gt; out.svg</p>
</blockquote>
<p>具体的参数参见项目FlameGraph所约定的参数，out.svg即是我们所需要的火焰图</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/05/thread-and-greed-think/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Finn Cheong">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AiTel">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/05/thread-and-greed-think/" itemprop="url">关于线程</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-11-05T17:09:06+08:00">
                2018-11-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="关于C-线程"><a href="#关于C-线程" class="headerlink" title="关于C++线程"></a>关于C++线程</h1><h4 id="Green-Threads"><a href="#Green-Threads" class="headerlink" title="Green Threads"></a>Green Threads</h4><p>green threads 是相对于native threads而言的，实际的green threads是依赖于jvm或者其他实现的，不论有多少，系统都认为它只是一条native thread，不能同时调度到不同的cpu中进行处理，现实意义上讲不能实现真正意义上的并行，而后出现了1:1的线程模型，Green Thread的线程概念就逐渐淡出。</p>
<hr>
<h4 id="Fibers-and-Coroutine"><a href="#Fibers-and-Coroutine" class="headerlink" title="Fibers and Coroutine"></a>Fibers and Coroutine</h4><p>纤程、微线程，就是轻量版的线程，如同线程对于进程而言。纤程的优点显而易见，无需线程的开销、上下文切换、变量加锁等，轻量使其比线程的更快更有优势，目前在lua和python均开始支持。<br>为了避免引入第三方的线程库，有些编程语言引入了协程——Coroutine的概念，在语法层面实现了纤程的功能。</p>
<hr>
<h4 id="Native-Threads"><a href="#Native-Threads" class="headerlink" title="Native Threads"></a>Native Threads</h4><p>Native Thread 就是我们一般意义上的线程概念，cpu的最小调度单元(green thread 与 fibers都是基于第三分库或者jvm实现的，底层依然是线程的实现)</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/03/02/quic1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Finn Cheong">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AiTel">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/02/quic1/" itemprop="url">QUIC I</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-02T19:35:05+08:00">
                2018-03-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="QUIC"><a href="#QUIC" class="headerlink" title="QUIC"></a>QUIC</h2><p>QUIC(Quick UDP Internet Connections)，QUIC实际就是基于UDP实现的可靠传输协议，包含了多种控制算法，其中最主要的如bbr、cubic等，当然可以根据具体的网络需求进行不同的切换。在QUIC中，基于逻辑的channel、stream和connect等设计，保证了QUIC可以和tcp一样完成有序可靠的重传。</p>
<hr>
<h2 id="QUIC-的优势在哪儿"><a href="#QUIC-的优势在哪儿" class="headerlink" title="QUIC 的优势在哪儿"></a>QUIC 的优势在哪儿</h2><ol>
<li>QUIC 相较于TCP，QUIC在既有缓存的情况下，可以实现0 RTT的握手</li>
<li>队头拥塞避免</li>
<li>对于连接的迁移</li>
<li>向前纠错的支持</li>
<li>拥塞控制算法(当然，目前大多数linux都已经支持BBR)</li>
</ol>
<hr>
<h3 id="关于0RTT握手"><a href="#关于0RTT握手" class="headerlink" title="关于0RTT握手"></a>关于0RTT握手</h3><p>0RTT，意思是当前无须产生握手操作，立即可以开始发送数据。<br>QUIC是如何实现0RTT的？首先在无任何缓存情况下，QUIC是无法实现0RTT的。<br>先来看一下熟悉的1RTT连接：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">client-&gt;server: syn</div><div class="line">server-&gt;client: syn/ack</div></pre></td></tr></table></figure></p>
<p>如果涉及到密钥交换，如https，握手过程应该是这样的：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">client-&gt;server: syn</div><div class="line">server-&gt;client: syn/ack</div><div class="line">client-&gt;server: client hello</div><div class="line">server-&gt;client: server hello、certificate、exchange key...</div><div class="line">client-&gt;server: certificate、exchange key、change finnish...</div><div class="line">server-&gt;client: change finnish</div><div class="line">client-&gt;server: send data</div></pre></td></tr></table></figure></p>
<p>故而这样一趟下来，将花费3个RTT。</p>
<p>首先，明确QUIC握手采用的是DH算法。<br>待续</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/11/22/ios-question/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Finn Cheong">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AiTel">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/11/22/ios-question/" itemprop="url">目前遇到的一些问题</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-11-22T15:31:48+08:00">
                2017-11-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="目前遇到的一些问题"><a href="#目前遇到的一些问题" class="headerlink" title="目前遇到的一些问题"></a>目前遇到的一些问题</h1><h3 id="为啥EAGLContext要setCurrentContext：nil"><a href="#为啥EAGLContext要setCurrentContext：nil" class="headerlink" title="为啥EAGLContext要setCurrentContext：nil"></a>为啥EAGLContext要setCurrentContext：nil</h3><hr>
<p>在iOS的OpenGL中，释放资源时我们最后一般会在最末调用setCurrentContext:nil，否则再一次使用时会产生crash。原因：苹果内部将维持了context，外部退出时，这个context可能就会失效，如果再次进入且被访问，就会crash。</p>
<h3 id="deleteDraw的坑"><a href="#deleteDraw的坑" class="headerlink" title="deleteDraw的坑"></a>deleteDraw的坑</h3><hr>
<p>当使用完OpenGL的时候，我们一般会调用deleteDraw销毁OpenGL的一些数据。但是，在此方法中会调用setCurrentContext:context，将当前的context设置进去。所以一定要保证setCurrentContext:nil在最后调用，不然可能依然会出现crash。</p>
<h3 id="关于二维码扫描"><a href="#关于二维码扫描" class="headerlink" title="关于二维码扫描"></a>关于二维码扫描</h3><hr>
<p>在改变metadataObjectTypes的时候一定要先设置addOutput，不然可能会出现意外的崩溃。</p>
<h3 id="AVAudioSessionThread-Notify-Thread-Crash"><a href="#AVAudioSessionThread-Notify-Thread-Crash" class="headerlink" title="AVAudioSessionThread Notify Thread Crash"></a>AVAudioSessionThread Notify Thread Crash</h3><hr>
<p>notify线程崩溃大多是外部去改变了sesison的属性导致的，因为AVAudio内部采用mrc，外部属性改变可能使内部变量意外release。大多是多线程引起的，尽可能的将属性的set与访问在这个通知线程中去做。[AVAudio sharedInstance] currentRout..]此方法可能导致session属性改变，故而尽量不要同时监听route时也去调用这个方法。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/10/09/OCMEM/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Finn Cheong">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AiTel">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/10/09/OCMEM/" itemprop="url">Objective-C 内存模型</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-10-09T21:05:14+08:00">
                2016-10-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="前篇"><a href="#前篇" class="headerlink" title="前篇"></a>前篇</h3><p>在Objective-C有说到Objective-C的消息机制。<br>Objective-C的内存模型时怎样的一个模型呢？</p>
<h3 id="Objective-C-对象"><a href="#Objective-C-对象" class="headerlink" title="Objective-C 对象"></a>Objective-C 对象</h3><blockquote>
<p>@interface NSObject <nsobject> {<br>Class isa  OBJC_ISA_AVAILABILITY;<br>}</nsobject></p>
</blockquote>
<p>在定义一个类的时候，其成员变量如上，发现它实际是一个Class。而Class的本质是一个<strong>结构体</strong>，如下：</p>
<blockquote>
<p>struct objc_class : objc_object {<br>    // Class ISA;<br>    Class superclass;<br>    cache_t cache;             // formerly cache pointer and vtable<br>    class_data_bits_t bits;    // class_rw_t * plus custom rr/alloc flags<br>    …<br>    …<br>    …<br>}</p>
</blockquote>
<p>从上面可以看到，Class实际是继承自object，那么OC里面的类从这里来讲它应该也是一个<strong>对象</strong>。</p>
<p>再次追溯objc_object对象的定义：</p>
<blockquote>
<p>struct objc_object {<br>private:<br>    isa_t isa;<br>public:<br>    Class ISA();<br>    Class getIsa();<br>    void initIsa(Class cls /<em>nonpointer=false</em>/);<br>    void initClassIsa(Class cls /<em>nonpointer=maybe</em>/);<br>    void initProtocolIsa(Class cls/<em>nonpointer=maybe</em>/);<br>    void initInstanceIsa(Class cls, bool hasCxxDtor);<br>    Class changeIsa(Class newCls);<br>    …<br>    …};</p>
</blockquote>
<p>显而易见，OC里面的类实际是一个结构体。</p>
<h3 id="模型"><a href="#模型" class="headerlink" title="模型"></a>模型</h3><p><img src="https://github.com/finncheong/finncheong.github.io/blob/master/images/1771779-ae456a9384128975.png?raw=true" alt="内存模型"></p>
<p>如上所示，OC中出现了元类的概念，同时元类是指向自己的。</p>
<p>对象的模型，isa 指针指向其类，其余空间保存各级的属性(ivar)：</p>
<p><img src="https://github.com/finncheong/finncheong.github.io/blob/master/images/1771779-76d9fd6e63c95a65.png?raw=true" alt="对象模型"></p>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p>C/C++/OC内存模型总结 <a href="http://www.jianshu.com/p/0c10b662ef09" target="_blank" rel="external">参考</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/09/30/oc-info/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Finn Cheong">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AiTel">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/09/30/oc-info/" itemprop="url">Objective-C 消息机制</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-09-30T14:05:14+08:00">
                2016-09-30
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="开头"><a href="#开头" class="headerlink" title="开头"></a>开头</h3><blockquote>
<p>使用消息结构而非函数调用</p>
</blockquote>
<p>使用消息结构的语言，其运行时执行的代码由运行时的具体环境来决定，典型的如OC。而使用函数调用的语言，典型如C等，则是由编译器决定的。<br>简单的两个特点：</p>
<ol>
<li>利用虚方法表来实现多态。</li>
<li>运行时的检查，OC的重要工作都由运行期的组件来完成而非编译器。</li>
</ol>
<p>在运行时，消息和方法通过objc_msgSend进行动态绑定。</p>
<blockquote>
<p>此时存在方法调用[receiver mssage]</p>
</blockquote>
<p>通过此调用整个逻辑转化objc_msgSend(receiver, selector)函数，该函数的参数实际是一个不定参数，其形式如objc_msgSend(receiver, selector,arg1,arg2,…)。一般的还会传入self和_cmd，编译器将会在编译时将这两个参数传入到函数中。</p>
<hr>
<h3 id="动态绑定"><a href="#动态绑定" class="headerlink" title="动态绑定"></a>动态绑定</h3><p>在前文中，提到了了消息机制实际是基于objc_msgSend这个函数的。但是在这个函数中如何实现动态绑定呢？<br>当[Object message]时，编译器会将这个方法调用转换成objc_msgSend函数</p>
<blockquote>
<p>该函数会根据Object的isa指针，找到其所属的类，然后在其类中的方法列表中查找这个message对应的@selector</p>
</blockquote>
<p>如果在这个类中没有找到则会遍历其父类，直到NSObject为止。一般的，OC中的类都是NSObject的子类。如果到NSObject都仍未找到则会调用_objc_msgForward函数，该函数用于消息转发。</p>
<hr>
<h3 id="关于消息转发"><a href="#关于消息转发" class="headerlink" title="关于消息转发"></a>关于消息转发</h3><ol>
<li>先征询接收者，检查是否存在的动态添加。</li>
<li>当运行完第1步时则不再检查，而查看其他对象是否有处理，如果没有处理则会启动完整的转发机制，封装到NSInvation中。</li>
</ol>
<p>完整的消息转发机制如下图<br><img src="https://github.com/finncheong/finncheong.github.io/blob/master/images/ocinfo.jpeg?raw=true" alt="消息转发图"></p>
<ol>
<li>resolveInstanceMethod 方法时，允许用户为类动态添加方法，如果此方法捕获到相应的实现则会进行调用。否则进行下一个方法调用。</li>
<li>forwardingTargetForSelector:方法，尝试找到一个能响应该消息的对象。如果获取到，则直接转发给它。如果返回了nil，继续下面的动作。</li>
<li>forwardInvocation方法，实际是处理methodSignatureForSelector（该方法将尝试获得一个方法签名。如果获取不到，则直接调用doesNotRecognizeSelector抛出异常）得到的签名，该签名被包装成Invocation传入，forwardInvocation方法中进行处理。如果处理失败则该消息将得不到处理。</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/09/25/linux_start/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Finn Cheong">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AiTel">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/09/25/linux_start/" itemprop="url">一个linux系统如何启动</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-09-25T10:05:14+08:00">
                2016-09-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="关于linux启动的问题"><a href="#关于linux启动的问题" class="headerlink" title="关于linux启动的问题"></a>关于linux启动的问题</h2><hr>
<p>其流程图如下所示：</p>
<p><img src="https://github.com/finncheong/finncheong.github.io/blob/master/images/linuxstart.jpeg?raw=true" alt="流程图"></p>
<ol>
<li>启动的第一步即是BIOS阶段，在BIOS阶段大多是已经写死的程序，程序员在这一步可做的更改很少。</li>
<li>第二步则是BIOS程序进行外设的初始化，如键盘鼠标等。因为当BIOS程序启动之后，可能是需要使用这些外设进行一系列的操作的。所以当BIOS启动完成之后一些不要的外设就会被初始化。</li>
<li>引导记录，主引导扇区记录着硬盘本身的相关信息以及硬盘各个分区的大小及位置信息，是数据信息的重要入口。 </li>
<li><p>这一步即是常说的Boot Loader，Boot Loader是一小段程序，用以初始化硬件设备、内存环境。让系统的软硬件环境达到合适的状态。</p>
<blockquote>
<p>大多数的Boot Loader分为两个模式：1、加载模式，即是从本地的硬盘中加载系统 2、下载模式，这种模式会通过网络去获取系统，从而加载。常见于很多学校的实验室中。</p>
</blockquote>
</li>
<li><p>内核启动。</p>
</li>
<li>启动系统的第一个进程/sbin/init进程，当此进程启动之后，系统的其他的一些程序（进程）才会启动。init是所有进程的父进程。<br>经过这样一个步骤，一个linux系统得以完全启动。</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpeg"
               alt="Finn Cheong" />
          <p class="site-author-name" itemprop="name">Finn Cheong</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">7</span>
                <span class="site-state-item-name">Artikel</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">2</span>
                <span class="site-state-item-name">Tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/finncheong" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                    
                      GitHub
                    
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Finn Cheong</span>
</div>


<div class="powered-by">
  Erstellt mit  <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  

  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  








  






  





  

  

  

  

  

  

</body>
</html>
